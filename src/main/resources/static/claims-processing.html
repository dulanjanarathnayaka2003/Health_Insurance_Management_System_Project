<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthInsure - Claims Processing</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <style>
      :root {
        --bg-gradient-1: #020617;
        --bg-gradient-2: #0f172a;
        --accent-cyan: #22d3ee;
        --accent-violet: #a855f7;
        --card-bg: rgba(15, 23, 42, 0.85);
        --border-subtle: rgba(148, 163, 184, 0.35);
        --text-main: #e5e7eb;
        --text-muted: #9ca3af;
        --danger: #f97373;
      }

      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      body {
        background: radial-gradient(circle at top, #0f172a 0, #020617 55%, #000 100%);
        min-height: 100vh;
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', system-ui, -system-ui, sans-serif;
        color: var(--text-main);
        line-height: 1.47;
        overflow-x: hidden;
      }

      /* Full-page animated background */
      .bg-orbit {
        position: fixed;
        inset: 0;
        overflow: hidden;
        z-index: -2;
      }

      .bg-orbit::before,
      .bg-orbit::after {
        content: "";
        position: absolute;
        width: 480px;
        height: 480px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 30%, rgba(56, 189, 248, 0.75), transparent 60%);
        filter: blur(4px);
        opacity: 0.55;
        animation: floatOrb 18s ease-in-out infinite;
      }

      .bg-orbit::after {
        top: auto;
        left: auto;
        right: -120px;
        bottom: -160px;
        background: radial-gradient(circle at 70% 70%, rgba(168, 85, 247, 0.85), transparent 60%);
        animation-delay: -9s;
      }

      .bg-grid {
        position: fixed;
        inset: 0;
        background-image:
          linear-gradient(to right, rgba(148, 163, 184, 0.08) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(148, 163, 184, 0.08) 1px, transparent 1px);
        background-size: 40px 40px;
        opacity: 0.7;
        mask-image: radial-gradient(circle at center, black 0, black 45%, transparent 80%);
        z-index: -1;
        animation: gridDrift 36s linear infinite;
      }

      @keyframes floatOrb {
        0%, 100% {
          transform: translate3d(-160px, -120px, 0) scale(1);
        }
        25% {
          transform: translate3d(40px, -200px, 0) scale(1.05);
        }
        50% {
          transform: translate3d(220px, 40px, 0) scale(1.08);
        }
        75% {
          transform: translate3d(-40px, 140px, 0) scale(1.03);
        }
      }

      @keyframes gridDrift {
        0% {
          transform: translate3d(0, 0, 0) scale(1);
        }
        50% {
          transform: translate3d(-40px, -20px, 0) scale(1.02);
        }
        100% {
          transform: translate3d(0, 0, 0) scale(1);
        }
      }
      
      /* Modern Header */
      header {
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        padding: 1.5rem 2rem;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .brand-lockup {
        display: flex;
        align-items: center;
        gap: 14px;
      }

      .brand-mark {
        width: 80px;
        height: 80px;
        border-radius: 16px;
        background: radial-gradient(circle at 30% 20%, #e5faff 0, #22d3ee 40%, #0ea5e9 75%, #0f172a 100%);
        box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.3),
                    0 18px 40px rgba(15, 23, 42, 0.9),
                    0 0 30px rgba(34, 211, 238, 0.4);
        position: relative;
        overflow: hidden;
        display: grid;
        place-items: center;
        animation: logoFloat 3s ease-in-out infinite, logoGlow 2s ease-in-out infinite;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .brand-mark:hover {
        transform: scale(1.05) rotate(5deg);
        box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.5),
                    0 25px 50px rgba(15, 23, 42, 1),
                    0 0 50px rgba(34, 211, 238, 0.6);
      }

      .brand-mark::before {
        content: "";
        position: absolute;
        inset: -2px;
        border-radius: 18px;
        background: linear-gradient(45deg, rgba(34, 211, 238, 0.8), rgba(168, 85, 247, 0.8), rgba(34, 211, 238, 0.8));
        background-size: 200% 200%;
        opacity: 0;
        z-index: -1;
        animation: logoShimmer 3s ease-in-out infinite;
      }

      .brand-mark img {
        width: 72px;
        height: 72px;
        object-fit: contain;
        border-radius: 12px;
        background: #0f172a;
        box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.35);
        animation: logoImagePulse 2.5s ease-in-out infinite;
        transition: transform 0.3s ease;
      }

      .brand-mark:hover img {
        transform: scale(1.08);
      }

      @keyframes logoFloat {
        0%, 100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-8px);
        }
      }

      @keyframes logoGlow {
        0%, 100% {
          box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.3),
                      0 18px 40px rgba(15, 23, 42, 0.9),
                      0 0 30px rgba(34, 211, 238, 0.4);
        }
        50% {
          box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.4),
                      0 20px 45px rgba(15, 23, 42, 1),
                      0 0 40px rgba(34, 211, 238, 0.6);
        }
      }

      @keyframes logoShimmer {
        0% {
          background-position: 0% 50%;
          opacity: 0;
        }
        50% {
          opacity: 0.3;
        }
        100% {
          background-position: 200% 50%;
          opacity: 0;
        }
      }

      @keyframes logoImagePulse {
        0%, 100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.02);
          opacity: 0.95;
        }
      }

      .brand-text-main {
        font-size: 1.8rem;
        font-weight: 600;
        letter-spacing: 0.09em;
        text-transform: uppercase;
        color: #e5e7eb;
      }

      .brand-text-sub {
        margin-top: 3px;
        font-size: 0.78rem;
        letter-spacing: 0.24em;
        text-transform: uppercase;
        color: var(--text-muted);
      }
      
      header h1 {
        font-weight: 600;
        font-size: 1.8rem;
        letter-spacing: 0.09em;
        text-transform: uppercase;
        color: #e5e7eb;
      }
      
      header p {
        font-size: 0.78rem;
        letter-spacing: 0.24em;
        text-transform: uppercase;
        color: var(--text-muted);
        margin-top: 3px;
      }
      
      /* Main container */
      .claims-container {
        max-width: 1400px;
        margin: 30px auto;
        padding: 0 20px;
        position: relative;
        z-index: 1;
      }
      
      /* Modern Tabs */
      .tabs {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin: 30px 0;
        gap: 10px;
        position: relative;
        z-index: 1;
      }
      
      .tab {
        padding: 12px 24px;
        background: rgba(15, 23, 42, 0.6);
        border-radius: 999px;
        color: var(--text-main);
        display: flex;
        align-items: center;
        gap: 0.5em;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        border: 1px solid rgba(148, 163, 184, 0.3);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        animation: cardEnter 0.7s cubic-bezier(0.22, 0.61, 0.36, 1) both;
      }

      .tab:nth-child(1) { animation-delay: 0.1s; }
      .tab:nth-child(2) { animation-delay: 0.2s; }
      .tab:nth-child(3) { animation-delay: 0.3s; }
      .tab:nth-child(4) { animation-delay: 0.4s; }
      
      .tab:hover {
        background: rgba(15, 23, 42, 0.8);
        border-color: var(--accent-cyan);
        transform: translateY(-2px);
      }
      
      .tab.active {
        background: linear-gradient(135deg, #22d3ee, #a855f7);
        color: #0b1120;
        border-color: transparent;
        box-shadow: 0 8px 20px rgba(34, 211, 238, 0.4);
      }
      
      /* Modern Content sections */
      .content {
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          radial-gradient(circle at 100% 100%, rgba(236, 72, 153, 0.2), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.92), rgba(15, 23, 42, 0.86));
        border-radius: 22px;
        padding: 30px;
        margin: 20px 0 40px;
        box-shadow:
          0 25px 60px rgba(15, 23, 42, 0.95),
          0 0 0 1px rgba(148, 163, 184, 0.4);
        border: 1px solid rgba(148, 163, 184, 0.35);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        display: none;
        animation: cardEnter 0.7s cubic-bezier(0.22, 0.61, 0.36, 1) both;
      }

      @keyframes cardEnter {
        0% {
          opacity: 0;
          transform: translate3d(0, 26px, 0) scale(0.97);
        }
        60% {
          opacity: 1;
          transform: translate3d(0, -6px, 0) scale(1.01);
        }
        100% {
          opacity: 1;
          transform: translate3d(0, 0, 0) scale(1);
        }
      }
      
      .content.active {
        display: block;
      }
      
      .content h3 {
        font-weight: 600;
        font-size: 1.5rem;
        margin-bottom: 25px;
        color: var(--text-main);
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      /* Modern Form elements */
      .form-group {
        margin-bottom: 20px;
      }
      
      .form-group label {
        display: block;
        font-weight: 500;
        margin-bottom: 8px;
        font-size: 0.85rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      
      .form-group input,
      .form-group textarea,
      .form-group select {
        width: 100%;
        padding: 12px 16px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 60%);
        color: var(--text-main);
        font-size: 0.9rem;
        font-family: inherit;
        transition: all 0.18s ease;
        outline: none;
      }

      .form-group textarea {
        border-radius: 16px;
        min-height: 100px;
        resize: vertical;
      }
      
      .form-group select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2364748b' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.75rem center;
        background-repeat: no-repeat;
        background-size: 1.2em 1.2em;
        padding-right: 2.5rem;
        cursor: pointer;
      }
      
      .form-group select:focus {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2322d3ee' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      }
      
      .form-group input:focus,
      .form-group textarea:focus,
      .form-group select:focus {
        border-color: var(--accent-cyan);
        box-shadow: 0 0 0 1px rgba(34, 211, 238, 0.3), 0 0 0 12px rgba(15, 23, 42, 0.8);
        background-color: rgba(15, 23, 42, 0.9);
        transform: translateY(-1px);
      }

      .form-group input::placeholder,
      .form-group textarea::placeholder {
        color: #6b7280;
      }
      
      .row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }
      
      /* Modern Gradient Buttons */
      .btn, .logout-btn, .btn-success, .btn-info, .btn-danger {
        border: none;
        outline: none;
        font-weight: 600;
        font-size: 0.9rem;
        border-radius: 999px;
        padding: 12px 24px;
        margin: 0 8px 8px 0;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      
      .btn, .btn-info, .btn-success {
        background: linear-gradient(135deg, #22d3ee, #a855f7);
        color: #0b1120;
        box-shadow: 0 8px 20px rgba(8, 47, 73, 0.7);
      }
      
      .btn-danger {
        background: linear-gradient(135deg, #f97373, #ef4444);
        color: #fff;
        box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
      }
      
      .logout-btn {
        background: linear-gradient(135deg, #22d3ee, #a855f7);
        color: #0b1120;
        margin-left: 12px;
        padding: 10px 20px;
        border-radius: 999px;
        box-shadow: 0 8px 20px rgba(8, 47, 73, 0.7);
      }
      
      .btn:hover, .btn-info:hover, .btn-success:hover, .logout-btn:hover {
        transform: translateY(-2px);
        filter: brightness(1.05);
        box-shadow: 0 12px 30px rgba(8, 47, 73, 0.9);
      }

      .btn-danger:hover {
        box-shadow: 0 12px 30px rgba(239, 68, 68, 0.6);
        transform: translateY(-2px);
      }
      
      /* Modern Tables */
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 0.9rem;
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.9));
        border-radius: 18px;
        overflow: hidden;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        box-shadow: 0 25px 60px rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.35);
      }
      
      th {
        background: linear-gradient(135deg, rgba(34, 211, 238, 0.3), rgba(168, 85, 247, 0.3));
        padding: 14px 16px;
        text-align: left;
        font-weight: 700;
        color: var(--text-main);
        border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      td {
        padding: 14px 16px;
        border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        color: var(--text-main);
      }
      
      tr:hover td {
        background: rgba(34, 211, 238, 0.1);
        transform: scale(1.01);
      }

      tbody tr:last-child td {
        border-bottom: none;
      }
      
      /* Modern Cards */
      .stat-card {
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.85));
        padding: 24px;
        border-radius: 18px;
        text-align: center;
        box-shadow: 0 8px 32px rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(148, 163, 184, 0.35);
        transition: all 0.3s ease;
        margin-bottom: 20px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      
      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(34, 211, 238, 0.3);
        border-color: var(--accent-cyan);
      }
      
      .stat-card h4 {
        margin: 0 0 10px 0;
        color: var(--text-muted);
        font-size: 0.85rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.02em;
      }
      
      .stat-card p {
        margin: 0;
        color: var(--accent-cyan);
        font-weight: 700;
        font-size: 1.8rem;
      }
      
      /* Modern Messages */
      .message {
        padding: 14px 20px;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 500;
        margin: 15px 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      
      .success {
        background: rgba(22, 163, 74, 0.2);
        color: #bbf7d0;
        border: 1px solid rgba(22, 163, 74, 0.4);
      }
      
      .error {
        background: rgba(127, 29, 29, 0.7);
        color: #fecaca;
        border: 1px solid rgba(248, 113, 113, 0.8);
      }
      
      /* Modern Modals */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        animation: fadeIn 0.2s ease-out;
      }
      
      .modal-content {
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.9));
        margin: 10% auto;
        padding: 30px;
        border-radius: 22px;
        width: 90%;
        max-width: 600px;
        box-shadow:
          0 25px 60px rgba(15, 23, 42, 0.95),
          0 0 0 1px rgba(148, 163, 184, 0.4);
        border: 1px solid rgba(148, 163, 184, 0.35);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        position: relative;
        animation: slideIn 0.3s ease-out;
        color: var(--text-main);
      }
      
      .close {
        color: var(--text-muted);
        float: right;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        top: 15px;
        right: 20px;
        cursor: pointer;
        transition: color 0.2s;
      }
      
      .close:hover {
        color: var(--accent-cyan);
      }
      
      /* Animations */
      @keyframes fadeIn {
        0% { opacity: 0; }
        100% { opacity: 1; }
      }
      
      @keyframes slideIn {
        0% { transform: translateY(-30px) scale(0.95); opacity: 0; }
        100% { transform: translateY(0) scale(1); opacity: 1; }
      }
      
      /* Modern Search boxes */
      .search-box {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }
      
      .search-box input {
        flex: 1;
        min-width: 250px;
        padding: 12px 16px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 60%);
        color: var(--text-main);
        font-size: 0.9rem;
      }
      
      .search-box input:focus {
        outline: none;
        border-color: var(--accent-cyan);
        box-shadow: 0 0 0 1px rgba(34, 211, 238, 0.3), 0 0 0 12px rgba(15, 23, 42, 0.8);
        background-color: rgba(15, 23, 42, 0.9);
        transform: translateY(-1px);
      }

      .search-box input::placeholder {
        color: #6b7280;
      }
      
      /* Modern Status badges */
      .status-badge {
        display: inline-block;
        padding: 0.4rem 0.8rem;
        border-radius: 2rem;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }
      
      .status-PENDING, .status-pending {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: #fff;
      }
      .status-APPROVED, .status-approved {
        background: linear-gradient(135deg, #10b981, #059669);
        color: #fff;
      }
      .status-REJECTED, .status-rejected {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: #fff;
      }
      .status-PAID, .status-paid {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: #fff;
      }
      .status-UNDER_REVIEW, .status-under_review {
        background: linear-gradient(135deg, #a855f7, #9333ea);
        color: #fff;
      }
      
      /* Additional styles */
      .row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .mb-8, .mt-6, .mt-8 {
        margin-bottom: 2rem;
      }

      .mt-6 {
        margin-top: 1.5rem;
      }

      .mt-8 {
        margin-top: 2rem;
      }

      .mb-4 {
        margin-bottom: 1rem;
      }

      .p-6 {
        padding: 1.5rem;
      }

      .bg-gray-50 {
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.85));
        border: 1px solid rgba(148, 163, 184, 0.35);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .border-gray-200 {
        border-color: rgba(148, 163, 184, 0.35);
      }

      .text-blue-600 {
        color: var(--accent-cyan);
      }

      .text-gray-500 {
        color: var(--text-muted);
      }

      .text-center {
        text-align: center;
      }

      .py-5 {
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
      }

      .report-preview {
        background:
          radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), transparent 55%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.85));
        border: 1px solid rgba(148, 163, 184, 0.35);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 18px;
        padding: 1.5rem;
      }

      .report-preview h4 {
        color: var(--text-main);
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .report-preview p {
        color: var(--text-main);
        margin-bottom: 0.5rem;
      }

      .report-preview strong {
        color: var(--accent-cyan);
      }

      .report-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }
      
      /* Responsive design */
      @media (max-width: 768px) {
        .claims-container {
          padding: 0 15px;
        }
        
        .content {
          padding: 20px;
        }
        
        .row {
          grid-template-columns: 1fr;
        }
        
        .tabs {
          gap: 0.3rem;
        }
        
        .tab {
          padding: 8px 16px;
          font-size: 0.85rem;
        }
        
        th, td {
          padding: 10px 12px;
        }
        
        .search-box {
          flex-direction: column;
        }
        
        .search-box input {
          min-width: 100%;
        }

        .brand-text-main {
          font-size: 1.4rem;
        }

        .brand-mark {
          width: 60px;
          height: 60px;
        }

        .brand-mark img {
          width: 54px;
          height: 54px;
        }
      }
    </style>
</head>
<body>
  <div class="bg-orbit"></div>
  <div class="bg-grid"></div>

<header>
  <div class="header-content">
    <div class="brand-lockup">
      <div class="brand-mark">
        <img src="Lanka.jpeg" alt="Lanka Health Insurance Logo">
      </div>
      <div>
        <div class="brand-text-main">Claims Processing</div>
        <div class="brand-text-sub">Efficient, Secure, Reliable</div>
      </div>
    </div>
    <button onclick="logout()" class="logout-btn">
      <i class="fas fa-sign-out-alt"></i>
      <span>Logout</span>
    </button>
  </div>
</header>
<div class="claims-container">
<div class="tabs">
    <div class="tab active" onclick="openTab('submit-claim', event)"><i class="fas fa-plus mr-1"></i> Submit Claim</div>
    <div class="tab" onclick="openTab('review-claims', event)"><i class="fas fa-tasks mr-1"></i> Review Claims</div>
    <div class="tab" onclick="openTab('search-claims', event)"><i class="fas fa-search mr-1"></i> Search Claims</div>
    <div class="tab" onclick="openTab('generate-report', event)"><i class="fas fa-chart-bar mr-1"></i> Generate Report</div>
</div>

<!-- Submit Claim Tab -->
<div id="submit-claim" class="content active">
    <h3>Submit New Claim</h3>
    
    <!-- Customer Search Section -->
    <div class="mb-8 p-6 bg-gray-50 rounded-xl border border-gray-200">
        <h4 class="text-lg font-semibold text-blue-600 mb-4">üîç Search Customer</h4>
        <div class="search-box">
            <input type="text" id="customerSearchInput" placeholder="Search by customer name, email, or phone">
            <button onclick="searchCustomersForClaim()" class="btn">Search</button>
            <button onclick="loadAllCustomersForClaim()" class="btn btn-info">Show All Customers</button>
        </div>
        <div id="customerSearchMessage"></div>
        
        <!-- Customer Table -->
        <table id="customerTable" class="mt-4">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Policy Number</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr><td colspan="7" class="text-center py-5 text-gray-500">Search for customers to select one for claim submission</td></tr>
            </tbody>
        </table>
    </div>
    
    <form id="claimForm" class="mt-6">
        <div class="row">
            <div class="form-group">
                <label>User ID *</label>
                <input type="number" id="userId" required placeholder="Enter user ID">
            </div>
            <div class="form-group">
                <label>Policy Number *</label>
                <input type="text" id="policyNumber" required placeholder="e.g., POL-001">
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label>Claim Amount *</label>
                <input type="number" id="claimAmount" step="0.01" required placeholder="Enter amount">
            </div>
            <div class="form-group">
                <label>Claim Date *</label>
                <input type="date" id="claimDate" required>
            </div>
        </div>
        <div class="form-group">
            <label>Claim Type / Description *</label>
            <textarea id="claimDescription" required placeholder="Enter claim type or description (e.g., Hospital admission, Surgery, Consultation)"></textarea>
        </div>
        <div class="mt-6">
            <button type="submit" class="btn">Submit Claim</button>
            <button type="button" onclick="clearClaimForm()" class="btn btn-danger">Clear</button>
        </div>
    </form>
    <div id="submitMessage"></div>
</div>

<!-- Review Claims Tab -->
<div id="review-claims" class="content">
    <h3>Review & Approve Claims</h3>
    <div class="mb-6">
        <button onclick="loadPendingClaims()" class="btn btn-info">Pending Claims</button>
        <button onclick="loadApprovedClaims()" class="btn btn-success">Approved Claims</button>
        <button onclick="loadRejectedClaims()" class="btn btn-danger">Rejected Claims</button>
        <button onclick="loadPaidClaims()" class="btn btn-danger">Paid Claims</button>
    </div>
    <table id="reviewClaimsTable">
        <thead>
            <tr>
                <th>Claim ID</th>
                <th>User</th>
                <th>Policy</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr><td colspan="7" class="text-center py-5 text-gray-500">Click any button above to view claims</td></tr>
        </tbody>
    </table>
</div>

<!-- Search Claims Tab -->
<div id="search-claims" class="content">
    <h3>Search All Claims</h3>
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search by Claim ID, User ID, or Policy Number">
        <button onclick="searchClaims()" class="btn">Search</button>
        <button onclick="loadAllClaims()" class="btn btn-info">Show All Claims</button>
    </div>
    <table id="searchClaimsTable" class="mt-6">
        <thead>
            <tr>
                <th>Claim ID</th>
                <th>User</th>
                <th>Policy</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr><td colspan="7" class="text-center py-5 text-gray-500">Enter search term or click "Show All Claims"</td></tr>
        </tbody>
    </table>
</div>

<!-- Generate Report Tab -->
<div id="generate-report" class="content">
    <h3>Generate Claims Report</h3>
    <form id="reportForm" class="mt-6">
        <div class="row">
            <div class="form-group">
                <label>Start Date *</label>
                <input type="date" id="startDate" required>
            </div>
            <div class="form-group">
                <label>End Date *</label>
                <input type="date" id="endDate" required>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label>Report Type *</label>
                <select id="reportType" required>
                    <option value="ALL">All Claims</option>
                    <option value="PENDING">Pending Claims</option>
                    <option value="APPROVED">Approved Claims</option>
                    <option value="REJECTED">Rejected Claims</option>
                    <option value="PAID">Paid Claims</option>
                    <option value="UNDER_REVIEW">Under Review</option>
                </select>
            </div>
            <div class="form-group">
                <label>Report Format *</label>
                <select id="reportFormat" required>
                    <option value="PDF">PDF Document</option>
                    <option value="DETAILED">Detailed PDF Report</option>
                </select>
            </div>
        </div>
        <div class="mt-6">
            <button type="button" onclick="previewReport()" class="btn btn-info">Preview Report</button>
            <button type="submit" class="btn btn-success">Generate & Download Report</button>
        </div>
    </form>
    <div id="reportMessage"></div>
    
    <div id="reportPreview" class="report-preview mt-8 p-6 bg-gray-50 rounded-xl border border-gray-200" style="display: none;">
        <h4 class="text-xl font-semibold mb-4">Report Preview</h4>
        <p class="mb-2"><strong>Period:</strong> <span id="previewPeriod"></span></p>
        <p class="mb-4"><strong>Type:</strong> <span id="previewType"></span></p>
        <div class="report-stats" id="reportStats"></div>
    </div>
</div>

<!-- Claim Details Modal -->
<div id="claimModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h3 class="text-xl font-semibold mb-4">Claim Details</h3>
        <div id="modalContent" class="mb-6"></div>
        <div>
            <button onclick="closeModal()" class="btn btn-danger">Close</button>
        </div>
    </div>
</div>

<!-- Approve/Reject Modal -->
<div id="approveModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeApproveModal()">&times;</span>
        <h3 class="text-xl font-semibold mb-4">Review Claim</h3>
        <input type="hidden" id="reviewClaimId">
        <div class="form-group">
            <label>Decision</label>
            <select id="reviewDecision" required class="mt-1">
                <option value="APPROVED">Approve</option>
                <option value="REJECTED">Reject</option>
                <option value="UNDER_REVIEW">Under Review</option>
            </select>
        </div>
        <div class="form-group">
            <label>Notes</label>
            <textarea id="reviewNotes" placeholder="Enter review notes" class="mt-1"></textarea>
        </div>
        <div class="mt-6">
            <button onclick="submitReview()" class="btn btn-success">Submit Decision</button>
            <button onclick="closeApproveModal()" class="btn btn-danger">Cancel</button>
        </div>
        <div id="reviewMessage" class="mt-4"></div>
    </div>
</div>

<!-- Bank Details & Payment Modal -->
<div id="paymentModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closePaymentModal()">&times;</span>
        <h3 class="text-xl font-semibold mb-4">üí≥ Process Payment</h3>
        <input type="hidden" id="paymentClaimId">
        <input type="hidden" id="paymentUserId">
        
        <div id="bankDetailsContent" class="mt-6">
            <p class="text-center text-gray-500">Loading bank details...</p>
        </div>
        
        <div id="paymentActions" class="mt-6 pt-6 border-t border-gray-200" style="display: none;">
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                <p class="font-medium text-yellow-700">
                    ‚ö†Ô∏è <strong>Confirm Payment:</strong> Clicking "Process Payment" will mark this claim as PAID.
                </p>
            </div>
            <button onclick="processPayment()" class="btn btn-success">‚úì Process Payment</button>
            <button onclick="closePaymentModal()" class="btn btn-danger">Cancel</button>
        </div>
    </div>
</div>

<script>
    const apiUrl = '/api/claims';
    
    function openTab(tabId, event) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        if (event && event.target) {
        event.target.classList.add('active');
        }
    }
    
    // Customer Search Functions
    async function searchCustomersForClaim() {
        const query = document.getElementById('customerSearchInput').value.trim();
        if (!query) {
            showMessage('customerSearchMessage', 'Please enter a search term', 'error');
            return;
        }
        
        try {
            const response = await fetch(`${apiUrl}/customers/search?query=${encodeURIComponent(query)}`);
            if (!response.ok) throw new Error('Search failed');
            
            const customers = await response.json();
            displayCustomersForClaim(customers);
            
            if (customers.length === 0) {
                showMessage('customerSearchMessage', 'No customers found', 'error');
            } else {
                showMessage('customerSearchMessage', `Found ${customers.length} customer(s)`, 'success');
            }
        } catch (error) {
            showMessage('customerSearchMessage', 'Search failed: ' + error.message, 'error');
        }
    }
    
    async function loadAllCustomersForClaim() {
        try {
            const response = await fetch(`${apiUrl}/customers`);
            if (!response.ok) throw new Error('Failed to load customers');
            
            const customers = await response.json();
            displayCustomersForClaim(customers);
            showMessage('customerSearchMessage', `Loaded ${customers.length} customers`, 'success');
        } catch (error) {
            showMessage('customerSearchMessage', 'Failed to load customers: ' + error.message, 'error');
        }
    }
    
    function displayCustomersForClaim(customers) {
        const tbody = document.querySelector('#customerTable tbody');
        tbody.innerHTML = '';
        
        if (customers.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">No customers found</td></tr>';
            return;
        }
        
        customers.forEach(customer => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${customer.id}</td>
                <td>${customer.name || 'N/A'}</td>
                <td>${customer.email || 'N/A'}</td>
                <td>${customer.phone || 'N/A'}</td>
                <td>${customer.policyNumber || 'N/A'}</td>
                <td><span class="status-badge ${customer.isActive ? 'status-APPROVED' : 'status-REJECTED'}">${customer.isActive ? 'Active' : 'Inactive'}</span></td>
                <td><button class="btn btn-success" onclick="selectCustomerForClaim(${customer.id}, '${customer.name}', '${customer.policyNumber || ''}')">Select</button></td>
            `;
            tbody.appendChild(tr);
        });
    }
    
    function selectCustomerForClaim(userId, customerName, policyNumber) {
        // Auto-fill the form fields
        document.getElementById('userId').value = userId;
        if (policyNumber && policyNumber !== 'N/A') {
            document.getElementById('policyNumber').value = policyNumber;
        }
        
        // Show success message
        showMessage('customerSearchMessage', `Selected customer: ${customerName} (ID: ${userId})`, 'success');
        
        // Scroll to form
        document.getElementById('claimForm').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Submit Claim
    document.getElementById('claimForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const data = {
            userId: document.getElementById('userId').value,
            policyNumber: document.getElementById('policyNumber').value,
            amount: parseFloat(document.getElementById('claimAmount').value),
            claimDate: document.getElementById('claimDate').value,
            description: document.getElementById('claimDescription').value,
            notes: null
        };
        
        try {
            const response = await fetch(apiUrl + '/submit-by-staff', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            
            if (!response.ok) {
                const error = await response.text();
                throw new Error(error || 'Failed to submit claim');
            }
            
            const result = await response.json();
            showMessage('submitMessage', 'Claim submitted successfully! Claim ID: ' + result.claimId, 'success');
            document.getElementById('claimForm').reset();
        } catch (error) {
            showMessage('submitMessage', 'Failed to submit claim: ' + error.message, 'error');
        }
    });
    
    function clearClaimForm() {
        document.getElementById('claimForm').reset();
        document.getElementById('submitMessage').innerHTML = '';
    }
    
    // Load Pending Claims
    async function loadPendingClaims() {
        try {
            const response = await fetch(apiUrl + '/pending');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const claims = await response.json();
            displayReviewClaims(claims);
        } catch (error) {
            alert('Failed to load claims: ' + error.message);
        }
    }
    
    // Load Approved Claims
    async function loadApprovedClaims() {
        try {
            const response = await fetch(apiUrl + '/all');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const allClaims = await response.json();
            const approvedClaims = allClaims.filter(claim => claim.status === 'APPROVED');
            displayReviewClaims(approvedClaims);
        } catch (error) {
            alert('Failed to load approved claims: ' + error.message);
        }
    }
    
    // Load Rejected Claims
    async function loadRejectedClaims() {
        try {
            const response = await fetch(apiUrl + '/all');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const allClaims = await response.json();
            const rejectedClaims = allClaims.filter(claim => claim.status === 'REJECTED');
            displayReviewClaims(rejectedClaims);
        } catch (error) {
            alert('Failed to load rejected claims: ' + error.message);
        }
    }
    
    // Load Paid Claims
    async function loadPaidClaims() {
        try {
            const response = await fetch(apiUrl + '/all');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const allClaims = await response.json();
            const paidClaims = allClaims.filter(claim => claim.status === 'PAID');
            displayReviewClaims(paidClaims);
        } catch (error) {
            alert('Failed to load paid claims: ' + error.message);
        }
    }
    
    function displayReviewClaims(claims) {
        const tbody = document.querySelector('#reviewClaimsTable tbody');
        tbody.innerHTML = '';
        
        if (claims.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">No claims found</td></tr>';
            return;
        }
        
        claims.forEach(claim => {
            const tr = document.createElement('tr');
            
            // For APPROVED claims, show Pay button instead of Review button
            let actionButtons = '';
            if (claim.status === 'APPROVED') {
                actionButtons = `
                    <button class="btn btn-info" onclick="viewClaimDetails('${claim.claimId}')">View</button>
                    <button class="btn btn-success" onclick="openPaymentModal('${claim.claimId}', ${claim.userId})">üí≥ Pay</button>
                `;
            } else {
                // For other statuses, show the Review button
                actionButtons = `
                    <button class="btn btn-info" onclick="viewClaimDetails('${claim.claimId}')">View</button>
                    <button class="btn btn-success" onclick="openApproveModal('${claim.claimId}')">Review</button>
                `;
            }
            
            tr.innerHTML = `
                <td>${claim.claimId}</td>
                <td>${claim.userId || 'N/A'}</td>
                <td>${claim.policyNumber || 'N/A'}</td>
                <td>LKR ${claim.amount.toFixed(2)}</td>
                <td>${claim.claimDate}</td>
                <td><span class="status-badge status-${claim.status}">${claim.status}</span></td>
                <td>${actionButtons}</td>
            `;
            tbody.appendChild(tr);
        });
    }
    
    // Search Claims
    async function searchClaims() {
        const query = document.getElementById('searchInput').value.trim();
        if (!query) {
            alert('Please enter a search term');
            return;
        }
        
        try {
            const response = await fetch(apiUrl + '/search?query=' + encodeURIComponent(query));
            if (!response.ok) throw new Error('Search failed');
            
            const claims = await response.json();
            displaySearchClaims(claims);
        } catch (error) {
            alert('Search failed: ' + error.message);
        }
    }
    
    async function loadAllClaims() {
        try {
            const response = await fetch(apiUrl + '/all');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const claims = await response.json();
            displaySearchClaims(claims);
        } catch (error) {
            alert('Failed to load claims: ' + error.message);
        }
    }
    
    function displaySearchClaims(claims) {
        const tbody = document.querySelector('#searchClaimsTable tbody');
        tbody.innerHTML = '';
        
        if (claims.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">No claims found</td></tr>';
            return;
        }
        
        claims.forEach(claim => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${claim.claimId}</td>
                <td>${claim.userId || 'N/A'}</td>
                <td>${claim.policyNumber || 'N/A'}</td>
                <td>LKR ${claim.amount.toFixed(2)}</td>
                <td>${claim.claimDate}</td>
                <td><span class="status-badge status-${claim.status}">${claim.status}</span></td>
                <td><button class="btn btn-info" onclick="viewClaimDetails('${claim.claimId}')">View Details</button></td>
            `;
            tbody.appendChild(tr);
        });
    }
    
    // View Claim Details
    async function viewClaimDetails(claimId) {
        try {
            const response = await fetch(apiUrl + '/' + claimId);
            if (!response.ok) throw new Error('Failed to load claim details');
            
            const claim = await response.json();
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <p><strong>Claim ID:</strong> ${claim.claimId}</p>
                <p><strong>User ID:</strong> ${claim.userId || 'N/A'}</p>
                <p><strong>Policy Number:</strong> ${claim.policyNumber || 'N/A'}</p>
                <p><strong>Amount:</strong> $${claim.amount.toFixed(2)}</p>
                <p><strong>Claim Date:</strong> ${claim.claimDate}</p>
                <p><strong>Status:</strong> <span class="status-badge status-${claim.status}">${claim.status}</span></p>
                <p><strong>Description:</strong> ${claim.description || 'N/A'}</p>
                <p><strong>Notes:</strong> ${claim.notes || 'No notes'}</p>
                <p><strong>Submitted:</strong> ${new Date(claim.createdAt).toLocaleString()}</p>
            `;
                document.getElementById('claimModal').style.display = 'block';
        } catch (error) {
            alert('Failed to load claim details: ' + error.message);
        }
    }

    function closeModal() {
        document.getElementById('claimModal').style.display = 'none';
    }

    // Approve/Reject Modal
    function openApproveModal(claimId) {
        document.getElementById('reviewClaimId').value = claimId;
        document.getElementById('approveModal').style.display = 'block';
    }
    
    function closeApproveModal() {
        document.getElementById('approveModal').style.display = 'none';
        document.getElementById('reviewMessage').innerHTML = '';
    }
    
    // Open Payment Modal and fetch bank details
    async function openPaymentModal(claimId, userId) {
        document.getElementById('paymentModal').style.display = 'block';
        document.getElementById('paymentClaimId').value = claimId;
        document.getElementById('paymentUserId').value = userId;
        
        // Reset content
        document.getElementById('bankDetailsContent').innerHTML = '<p style="text-align: center; color: #666;">Loading bank details...</p>';
        document.getElementById('paymentActions').style.display = 'none';
        
        try {
            // Fetch user details with bank account information
            const response = await fetch(`/api/claims/customer-bank-details/${userId}`);
            if (!response.ok) throw new Error('Failed to load user details');
            
            const user = await response.json();
            
            // Display bank details
            let bankDetailsHTML = '';
            if (user.bankName && user.accountNumber) {
                bankDetailsHTML = `
                    <div style="background: #e7f3ff; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff;">
                        <h4 style="margin-top: 0; color: #007bff;">Customer Information</h4>
                        <div style="margin-bottom: 15px;">
                            <strong>Name:</strong> ${user.name || 'N/A'}<br>
                            <strong>User ID:</strong> ${user.id}<br>
                            <strong>Email:</strong> ${user.email || 'N/A'}<br>
                            <strong>Phone:</strong> ${user.phone || 'N/A'}
                        </div>
                        
                        <h4 style="color: #28a745; margin-bottom: 10px;">üè¶ Bank Account Details</h4>
                        <table style="width: 100%; background: white; border-radius: 4px;">
                            <tr>
                                <td style="padding: 10px; font-weight: 600; border-bottom: 1px solid #dee2e6; width: 40%;">Bank Name:</td>
                                <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">${user.bankName}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: 600; border-bottom: 1px solid #dee2e6;">Account Number:</td>
                                <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">${user.accountNumber}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: 600; border-bottom: 1px solid #dee2e6;">Account Holder:</td>
                                <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">${user.accountHolderName || user.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: 600;">Branch:</td>
                                <td style="padding: 10px;">${user.branch || 'N/A'}</td>
                            </tr>
                        </table>
                        
                        <div style="margin-top: 15px; padding: 10px; background: #d4edda; border-left: 3px solid #28a745; border-radius: 4px;">
                            <strong style="color: #155724;">Claim ID:</strong> ${claimId}
                        </div>
                    </div>
                `;
                document.getElementById('paymentActions').style.display = 'block';
            } else {
                bankDetailsHTML = `
                    <div style="background: #f8d7da; padding: 20px; border-radius: 8px; border-left: 4px solid #dc3545;">
                        <h4 style="margin-top: 0; color: #dc3545;">‚ùå No Bank Account Found</h4>
                        <p>This customer does not have bank account details on file.</p>
                        <p><strong>Customer:</strong> ${user.name || 'N/A'} (ID: ${user.id})</p>
                        <p style="margin-bottom: 0;">Please ask the customer to provide their bank account information before processing payment.</p>
                    </div>
                `;
            }
            
            document.getElementById('bankDetailsContent').innerHTML = bankDetailsHTML;
            
        } catch (error) {
            console.error('Error loading bank details:', error);
            document.getElementById('bankDetailsContent').innerHTML = `
                <div style="background: #f8d7da; padding: 20px; border-radius: 8px; border-left: 4px solid #dc3545;">
                    <h4 style="margin-top: 0; color: #dc3545;">‚ùå Error</h4>
                    <p>Failed to load bank details: ${error.message}</p>
                </div>
            `;
        }
    }
    
    function closePaymentModal() {
        document.getElementById('paymentModal').style.display = 'none';
    }
    
    async function processPayment() {
        const claimId = document.getElementById('paymentClaimId').value;
        
        if (!confirm('Are you sure you want to mark this claim as PAID? This action will update the claim status.')) {
            return;
        }
        
        try {
            const response = await fetch(`${apiUrl}/${claimId}/status`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    status: 'PAID',
                    notes: 'Payment processed successfully'
                })
            });
            
            if (!response.ok) throw new Error('Failed to process payment');
            
            alert('‚úÖ Payment processed successfully! Claim marked as PAID.');
            closePaymentModal();
            
            // Reload the claims list
            loadApprovedClaims();
            
        } catch (error) {
            console.error('Error processing payment:', error);
            alert('‚ùå Failed to process payment: ' + error.message);
        }
    }
    
    async function submitReview() {
        const claimId = document.getElementById('reviewClaimId').value;
        const decision = document.getElementById('reviewDecision').value;
        const notes = document.getElementById('reviewNotes').value;
        
        console.log('=== FRONTEND: Submitting Review ===');
        console.log('Claim ID:', claimId);
        console.log('Decision:', decision);
        console.log('Notes:', notes);
        console.log('Request URL:', apiUrl + '/' + claimId + '/status');
        
        const requestBody = { status: decision, notes: notes };
        console.log('Request Body:', JSON.stringify(requestBody));
        
        try {
            const response = await fetch(apiUrl + '/' + claimId + '/status', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            });
            
            console.log('Response status:', response.status);
            console.log('Response ok:', response.ok);
            
            if (!response.ok) {
                const errorText = await response.text();
                console.error('Error response:', errorText);
                throw new Error('Failed to update claim: ' + errorText);
            }
            
            const result = await response.json();
            console.log('Success response:', result);
            
            showMessage('reviewMessage', `Claim ${claimId} updated to ${decision}! The claim will be removed from pending list.`, 'success');
            setTimeout(() => {
                closeApproveModal();
                loadPendingClaims(); // Refresh to show remaining pending claims
                // Also switch to Search tab to see all claims
                document.getElementById('reviewMessage').innerHTML = '';
            }, 2000);
        } catch (error) {
            console.error('Error updating claim:', error);
            showMessage('reviewMessage', 'Failed to update claim: ' + error.message, 'error');
        }
    }
    
    // Preview Report
    async function previewReport() {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;
        const reportType = document.getElementById('reportType').value;
        
        if (!startDate || !endDate) {
            alert('Please select both start and end dates');
            return;
        }
        
        try {
            const response = await fetch(apiUrl + '/all');
            if (!response.ok) throw new Error('Failed to load claims');
            
            const allClaims = await response.json();
            const filteredClaims = allClaims.filter(claim => {
                const claimDate = new Date(claim.claimDate);
                const start = new Date(startDate);
                const end = new Date(endDate);
                const matchesDate = claimDate >= start && claimDate <= end;
                const matchesType = reportType === 'ALL' || claim.status === reportType;
                return matchesDate && matchesType;
            });
            
            // Calculate statistics
            const totalClaims = filteredClaims.length;
            const totalAmount = filteredClaims.reduce((sum, claim) => sum + claim.amount, 0);
            const approvedClaims = filteredClaims.filter(c => c.status === 'APPROVED').length;
            const pendingClaims = filteredClaims.filter(c => c.status === 'PENDING').length;
            const rejectedClaims = filteredClaims.filter(c => c.status === 'REJECTED').length;
            
            // Display preview
            document.getElementById('previewPeriod').textContent = `${startDate} to ${endDate}`;
            document.getElementById('previewType').textContent = reportType;
            
            const statsHtml = `
                <div class="stat-card">
                    <h4>Total Claims</h4>
                    <p>${totalClaims}</p>
                </div>
                <div class="stat-card">
                    <h4>Total Amount</h4>
                    <p>LKR ${totalAmount.toFixed(2)}</p>
                </div>
                <div class="stat-card" style="border-left-color: #28a745;">
                    <h4>Approved</h4>
                    <p style="color: #28a745;">${approvedClaims}</p>
                </div>
                <div class="stat-card" style="border-left-color: #ffc107;">
                    <h4>Pending</h4>
                    <p style="color: #ffc107;">${pendingClaims}</p>
                </div>
                <div class="stat-card" style="border-left-color: #dc3545;">
                    <h4>Rejected</h4>
                    <p style="color: #dc3545;">${rejectedClaims}</p>
                </div>
            `;
            
            document.getElementById('reportStats').innerHTML = statsHtml;
            document.getElementById('reportPreview').style.display = 'block';
            
            showMessage('reportMessage', 'Report preview generated successfully!', 'success');
        } catch (error) {
            showMessage('reportMessage', 'Failed to generate preview: ' + error.message, 'error');
        }
    }
    
    // Generate Report
    document.getElementById('reportForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;
        const reportType = document.getElementById('reportType').value;
        
        try {
            const response = await fetch(apiUrl + `/report?startDate=${startDate}&endDate=${endDate}&type=${reportType}`);
            
            if (!response.ok) throw new Error('Failed to generate report');
            
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `claims_report_${startDate}_${endDate}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showMessage('reportMessage', 'Report generated and downloaded successfully!', 'success');
        } catch (error) {
            showMessage('reportMessage', 'Failed to generate report: ' + error.message, 'error');
        }
    });
    
    function showMessage(elementId, message, type) {
        const el = document.getElementById(elementId);
        el.innerHTML = `<div class="message ${type}">${message}</div>`;
        setTimeout(() => el.innerHTML = '', 5000);
    }

    function logout() {
        if (confirm('Are you sure you want to logout?')) {
        window.location.href = '/logout';
        }
    }
    
    // Set today's date as default
    document.getElementById('claimDate').valueAsDate = new Date();
    
    // Set default date range for report (last 30 days)
    const today = new Date();
    const thirtyDaysAgo = new Date(today.getTime() - (30 * 24 * 60 * 60 * 1000));
    document.getElementById('endDate').valueAsDate = today;
    document.getElementById('startDate').valueAsDate = thirtyDaysAgo;
</script>
</body>
</html>
